import{p as qt}from"./pako.esm-BpSz_pCI.js";import{q as Vt}from"./qrcode-BB1qHw6L.js";import{r as Kt}from"./renderer-Cp9WJrM7.js";/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function mt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),i.push.apply(i,n)}return i}function W(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};e%2?mt(Object(i),!0).forEach(function(n){Jt(t,n,i[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):mt(Object(i)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))})}return t}function Ye(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ye=function(e){return typeof e}:Ye=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(t)}function Jt(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function K(){return K=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},K.apply(this,arguments)}function Qt(t,e){if(t==null)return{};var i={},n=Object.keys(t),o,r;for(r=0;r<n.length;r++)o=n[r],!(e.indexOf(o)>=0)&&(i[o]=t[o]);return i}function Zt(t,e){if(t==null)return{};var i=Qt(t,e),n,o;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)n=r[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var en="1.15.6";function V(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var J=V(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ne=V(/Edge/i),gt=V(/firefox/i),_e=V(/safari/i)&&!V(/chrome/i)&&!V(/android/i),dt=V(/iP(ad|od|hone)/i),It=V(/chrome/i)&&V(/android/i),Ct={capture:!1,passive:!1};function v(t,e,i){t.addEventListener(e,i,!J&&Ct)}function g(t,e,i){t.removeEventListener(e,i,!J&&Ct)}function Ge(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Tt(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function $(t,e,i,n){if(t){i=i||document;do{if(e!=null&&(e[0]===">"?t.parentNode===i&&Ge(t,e):Ge(t,e))||n&&t===i)return t;if(t===i)break}while(t=Tt(t))}return null}var vt=/\s+/g;function B(t,e,i){if(t&&e)if(t.classList)t.classList[i?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(vt," ").replace(" "+e+" "," ");t.className=(n+(i?" "+e:"")).replace(vt," ")}}function p(t,e,i){var n=t&&t.style;if(n){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),e===void 0?i:i[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=i+(typeof i=="string"?"":"px")}}function pe(t,e){var i="";if(typeof t=="string")i=t;else do{var n=p(t,"transform");n&&n!=="none"&&(i=n+" "+i)}while(!e&&(t=t.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(i)}function Ot(t,e,i){if(t){var n=t.getElementsByTagName(e),o=0,r=n.length;if(i)for(;o<r;o++)i(n[o],o);return n}return[]}function z(){var t=document.scrollingElement;return t||document.documentElement}function T(t,e,i,n,o){if(!(!t.getBoundingClientRect&&t!==window)){var r,a,s,l,c,u,f;if(t!==window&&t.parentNode&&t!==z()?(r=t.getBoundingClientRect(),a=r.top,s=r.left,l=r.bottom,c=r.right,u=r.height,f=r.width):(a=0,s=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||i)&&t!==window&&(o=o||t.parentNode,!J))do if(o&&o.getBoundingClientRect&&(p(o,"transform")!=="none"||i&&p(o,"position")!=="static")){var b=o.getBoundingClientRect();a-=b.top+parseInt(p(o,"border-top-width")),s-=b.left+parseInt(p(o,"border-left-width")),l=a+r.height,c=s+r.width;break}while(o=o.parentNode);if(n&&t!==window){var S=pe(o||t),y=S&&S.a,w=S&&S.d;S&&(a/=w,s/=y,f/=y,u/=w,l=a+u,c=s+f)}return{top:a,left:s,bottom:l,right:c,width:f,height:u}}}function bt(t,e,i){for(var n=ne(t,!0),o=T(t)[e];n;){var r=T(n)[i],a=void 0;if(a=o>=r,!a)return n;if(n===z())break;n=ne(n,!1)}return!1}function me(t,e,i,n){for(var o=0,r=0,a=t.children;r<a.length;){if(a[r].style.display!=="none"&&a[r]!==h.ghost&&(n||a[r]!==h.dragged)&&$(a[r],i.draggable,t,!1)){if(o===e)return a[r];o++}r++}return null}function ut(t,e){for(var i=t.lastElementChild;i&&(i===h.ghost||p(i,"display")==="none"||e&&!Ge(i,e));)i=i.previousElementSibling;return i||null}function Y(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==h.clone&&(!e||Ge(t,e))&&i++;return i}function yt(t){var e=0,i=0,n=z();if(t)do{var o=pe(t),r=o.a,a=o.d;e+=t.scrollLeft*r,i+=t.scrollTop*a}while(t!==n&&(t=t.parentNode));return[e,i]}function tn(t,e){for(var i in t)if(t.hasOwnProperty(i)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[i][n])return Number(i)}return-1}function ne(t,e){if(!t||!t.getBoundingClientRect)return z();var i=t,n=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var o=p(i);if(i.clientWidth<i.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return z();if(n||e)return i;n=!0}}while(i=i.parentNode);return z()}function nn(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function Ke(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var Ie;function At(t,e){return function(){if(!Ie){var i=arguments,n=this;i.length===1?t.call(n,i[0]):t.apply(n,i),Ie=setTimeout(function(){Ie=void 0},e)}}}function on(){clearTimeout(Ie),Ie=void 0}function xt(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function Pt(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}function Nt(t,e,i){var n={};return Array.from(t.children).forEach(function(o){var r,a,s,l;if(!(!$(o,e.draggable,t,!1)||o.animated||o===i)){var c=T(o);n.left=Math.min((r=n.left)!==null&&r!==void 0?r:1/0,c.left),n.top=Math.min((a=n.top)!==null&&a!==void 0?a:1/0,c.top),n.right=Math.max((s=n.right)!==null&&s!==void 0?s:-1/0,c.right),n.bottom=Math.max((l=n.bottom)!==null&&l!==void 0?l:-1/0,c.bottom)}}),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var L="Sortable"+new Date().getTime();function rn(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(o){if(!(p(o,"display")==="none"||o===h.ghost)){t.push({target:o,rect:T(o)});var r=W({},t[t.length-1].rect);if(o.thisAnimationDuration){var a=pe(o,!0);a&&(r.top-=a.f,r.left-=a.e)}o.fromRect=r}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(tn(t,{target:n}),1)},animateAll:function(n){var o=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var r=!1,a=0;t.forEach(function(s){var l=0,c=s.target,u=c.fromRect,f=T(c),b=c.prevFromRect,S=c.prevToRect,y=s.rect,w=pe(c,!0);w&&(f.top-=w.f,f.left-=w.e),c.toRect=f,c.thisAnimationDuration&&Ke(b,f)&&!Ke(u,f)&&(y.top-f.top)/(y.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(l=sn(y,b,S,o.options)),Ke(f,u)||(c.prevFromRect=u,c.prevToRect=f,l||(l=o.options.animation),o.animate(c,y,f,l)),l&&(r=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),r?e=setTimeout(function(){typeof n=="function"&&n()},a):typeof n=="function"&&n(),t=[]},animate:function(n,o,r,a){if(a){p(n,"transition",""),p(n,"transform","");var s=pe(this.el),l=s&&s.a,c=s&&s.d,u=(o.left-r.left)/(l||1),f=(o.top-r.top)/(c||1);n.animatingX=!!u,n.animatingY=!!f,p(n,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=an(n),p(n,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),p(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){p(n,"transition",""),p(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},a)}}}}function an(t){return t.offsetWidth}function sn(t,e,i,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))*n.animation}var de=[],Je={initializeByDefault:!0},Me={mount:function(e){for(var i in Je)Je.hasOwnProperty(i)&&!(i in e)&&(e[i]=Je[i]);de.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),de.push(e)},pluginEvent:function(e,i,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var r=e+"Global";de.forEach(function(a){i[a.pluginName]&&(i[a.pluginName][r]&&i[a.pluginName][r](W({sortable:i},n)),i.options[a.pluginName]&&i[a.pluginName][e]&&i[a.pluginName][e](W({sortable:i},n)))})},initializePlugins:function(e,i,n,o){de.forEach(function(s){var l=s.pluginName;if(!(!e.options[l]&&!s.initializeByDefault)){var c=new s(e,i,e.options);c.sortable=e,c.options=e.options,e[l]=c,K(n,c.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var a=this.modifyOption(e,r,e.options[r]);typeof a<"u"&&(e.options[r]=a)}},getEventProperties:function(e,i){var n={};return de.forEach(function(o){typeof o.eventProperties=="function"&&K(n,o.eventProperties.call(i[o.pluginName],e))}),n},modifyOption:function(e,i,n){var o;return de.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[i]=="function"&&(o=r.optionListeners[i].call(e[r.pluginName],n))}),o}};function ln(t){var e=t.sortable,i=t.rootEl,n=t.name,o=t.targetEl,r=t.cloneEl,a=t.toEl,s=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,b=t.originalEvent,S=t.putSortable,y=t.extraEventProperties;if(e=e||i&&i[L],!!e){var w,X=e.options,U="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!J&&!Ne?w=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(w=document.createEvent("Event"),w.initEvent(n,!0,!0)),w.to=a||i,w.from=s||i,w.item=o||i,w.clone=r,w.oldIndex=l,w.newIndex=c,w.oldDraggableIndex=u,w.newDraggableIndex=f,w.originalEvent=b,w.pullMode=S?S.lastPutMode:void 0;var P=W(W({},y),Me.getEventProperties(n,e));for(var j in P)w[j]=P[j];i&&i.dispatchEvent(w),X[U]&&X[U].call(e,w)}}var cn=["evt"],M=function(e,i){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=n.evt,r=Zt(n,cn);Me.pluginEvent.bind(h)(e,i,W({dragEl:d,parentEl:I,ghostEl:m,rootEl:D,nextEl:le,lastDownEl:Xe,cloneEl:_,cloneHidden:te,dragStarted:we,putSortable:O,activeSortable:h.active,originalEvent:o,oldIndex:he,oldDraggableIndex:Ce,newIndex:k,newDraggableIndex:ee,hideGhostForTarget:Rt,unhideGhostForTarget:Bt,cloneNowHidden:function(){te=!0},cloneNowShown:function(){te=!1},dispatchSortableEvent:function(s){N({sortable:i,name:s,originalEvent:o})}},r))};function N(t){ln(W({putSortable:O,cloneEl:_,targetEl:d,rootEl:D,oldIndex:he,oldDraggableIndex:Ce,newIndex:k,newDraggableIndex:ee},t))}var d,I,m,D,le,Xe,_,te,he,k,Ce,ee,Fe,O,fe=!1,ze=!1,We=[],ae,H,Qe,Ze,Et,wt,we,ue,Te,Oe=!1,Re=!1,je,A,et=[],at=!1,Ue=[],Ve=typeof document<"u",Be=dt,St=Ne||J?"cssFloat":"float",dn=Ve&&!It&&!dt&&"draggable"in document.createElement("div"),Mt=function(){if(Ve){if(J)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),Lt=function(e,i){var n=p(e),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),r=me(e,0,i),a=me(e,1,i),s=r&&p(r),l=a&&p(a),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+T(r).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+T(a).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return r&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=o&&n[St]==="none"||a&&n[St]==="none"&&c+u>o)?"vertical":"horizontal"},un=function(e,i,n){var o=n?e.left:e.top,r=n?e.right:e.bottom,a=n?e.width:e.height,s=n?i.left:i.top,l=n?i.right:i.bottom,c=n?i.width:i.height;return o===s||r===l||o+a/2===s+c/2},fn=function(e,i){var n;return We.some(function(o){var r=o[L].options.emptyInsertThreshold;if(!(!r||ut(o))){var a=T(o),s=e>=a.left-r&&e<=a.right+r,l=i>=a.top-r&&i<=a.bottom+r;if(s&&l)return n=o}}),n},Ft=function(e){function i(r,a){return function(s,l,c,u){var f=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(r==null&&(a||f))return!0;if(r==null||r===!1)return!1;if(a&&r==="clone")return r;if(typeof r=="function")return i(r(s,l,c,u),a)(s,l,c,u);var b=(a?s:l).options.group.name;return r===!0||typeof r=="string"&&r===b||r.join&&r.indexOf(b)>-1}}var n={},o=e.group;(!o||Ye(o)!="object")&&(o={name:o}),n.name=o.name,n.checkPull=i(o.pull,!0),n.checkPut=i(o.put),n.revertClone=o.revertClone,e.group=n},Rt=function(){!Mt&&m&&p(m,"display","none")},Bt=function(){!Mt&&m&&p(m,"display","")};Ve&&!It&&document.addEventListener("click",function(t){if(ze)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),ze=!1,!1},!0);var se=function(e){if(d){e=e.touches?e.touches[0]:e;var i=fn(e.clientX,e.clientY);if(i){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.target=n.rootEl=i,n.preventDefault=void 0,n.stopPropagation=void 0,i[L]._onDragOver(n)}}},hn=function(e){d&&d.parentNode[L]._isOutsideThisEl(e.target)};function h(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=K({},e),t[L]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Lt(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:h.supportPointer!==!1&&"PointerEvent"in window&&(!_e||dt),emptyInsertThreshold:5};Me.initializePlugins(this,t,i);for(var n in i)!(n in e)&&(e[n]=i[n]);Ft(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:dn,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?v(t,"pointerdown",this._onTapStart):(v(t,"mousedown",this._onTapStart),v(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(v(t,"dragover",this),v(t,"dragenter",this)),We.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),K(this,rn())}h.prototype={constructor:h,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(ue=null)},_getDirection:function(e,i){return typeof this.options.direction=="function"?this.options.direction.call(this,e,i,d):this.options.direction},_onTapStart:function(e){if(e.cancelable){var i=this,n=this.el,o=this.options,r=o.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(s||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=o.filter;if(wn(n),!d&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||o.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&_e&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=$(l,o.draggable,n,!1),!(l&&l.animated)&&Xe!==l)){if(he=Y(l),Ce=Y(l,o.draggable),typeof u=="function"){if(u.call(this,e,l,this)){N({sortable:i,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),M("filter",i,{evt:e}),r&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=$(c,f.trim(),n,!1),f)return N({sortable:i,rootEl:f,name:"filter",targetEl:l,fromEl:n,toEl:n}),M("filter",i,{evt:e}),!0}),u)){r&&e.preventDefault();return}o.handle&&!$(c,o.handle,n,!1)||this._prepareDragStart(e,s,l)}}},_prepareDragStart:function(e,i,n){var o=this,r=o.el,a=o.options,s=r.ownerDocument,l;if(n&&!d&&n.parentNode===r){var c=T(n);if(D=r,d=n,I=d.parentNode,le=d.nextSibling,Xe=n,Fe=a.group,h.dragged=d,ae={target:d,clientX:(i||e).clientX,clientY:(i||e).clientY},Et=ae.clientX-c.left,wt=ae.clientY-c.top,this._lastX=(i||e).clientX,this._lastY=(i||e).clientY,d.style["will-change"]="all",l=function(){if(M("delayEnded",o,{evt:e}),h.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!gt&&o.nativeDraggable&&(d.draggable=!0),o._triggerDragStart(e,i),N({sortable:o,name:"choose",originalEvent:e}),B(d,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){Ot(d,u.trim(),tt)}),v(s,"dragover",se),v(s,"mousemove",se),v(s,"touchmove",se),a.supportPointer?(v(s,"pointerup",o._onDrop),!this.nativeDraggable&&v(s,"pointercancel",o._onDrop)):(v(s,"mouseup",o._onDrop),v(s,"touchend",o._onDrop),v(s,"touchcancel",o._onDrop)),gt&&this.nativeDraggable&&(this.options.touchStartThreshold=4,d.draggable=!0),M("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(Ne||J))){if(h.eventCanceled){this._onDrop();return}a.supportPointer?(v(s,"pointerup",o._disableDelayedDrag),v(s,"pointercancel",o._disableDelayedDrag)):(v(s,"mouseup",o._disableDelayedDrag),v(s,"touchend",o._disableDelayedDrag),v(s,"touchcancel",o._disableDelayedDrag)),v(s,"mousemove",o._delayedDragTouchMoveHandler),v(s,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&v(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var i=e.touches?e.touches[0]:e;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){d&&tt(d),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._disableDelayedDrag),g(e,"touchend",this._disableDelayedDrag),g(e,"touchcancel",this._disableDelayedDrag),g(e,"pointerup",this._disableDelayedDrag),g(e,"pointercancel",this._disableDelayedDrag),g(e,"mousemove",this._delayedDragTouchMoveHandler),g(e,"touchmove",this._delayedDragTouchMoveHandler),g(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,i){i=i||e.pointerType=="touch"&&e,!this.nativeDraggable||i?this.options.supportPointer?v(document,"pointermove",this._onTouchMove):i?v(document,"touchmove",this._onTouchMove):v(document,"mousemove",this._onTouchMove):(v(d,"dragend",this),v(D,"dragstart",this._onDragStart));try{document.selection?He(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,i){if(fe=!1,D&&d){M("dragStarted",this,{evt:i}),this.nativeDraggable&&v(document,"dragover",hn);var n=this.options;!e&&B(d,n.dragClass,!1),B(d,n.ghostClass,!0),h.active=this,e&&this._appendGhost(),N({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(H){this._lastX=H.clientX,this._lastY=H.clientY,Rt();for(var e=document.elementFromPoint(H.clientX,H.clientY),i=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(H.clientX,H.clientY),e!==i);)i=e;if(d.parentNode[L]._isOutsideThisEl(e),i)do{if(i[L]){var n=void 0;if(n=i[L]._onDragOver({clientX:H.clientX,clientY:H.clientY,target:e,rootEl:i}),n&&!this.options.dragoverBubble)break}e=i}while(i=Tt(i));Bt()}},_onTouchMove:function(e){if(ae){var i=this.options,n=i.fallbackTolerance,o=i.fallbackOffset,r=e.touches?e.touches[0]:e,a=m&&pe(m,!0),s=m&&a&&a.a,l=m&&a&&a.d,c=Be&&A&&yt(A),u=(r.clientX-ae.clientX+o.x)/(s||1)+(c?c[0]-et[0]:0)/(s||1),f=(r.clientY-ae.clientY+o.y)/(l||1)+(c?c[1]-et[1]:0)/(l||1);if(!h.active&&!fe){if(n&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(m){a?(a.e+=u-(Qe||0),a.f+=f-(Ze||0)):a={a:1,b:0,c:0,d:1,e:u,f};var b="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");p(m,"webkitTransform",b),p(m,"mozTransform",b),p(m,"msTransform",b),p(m,"transform",b),Qe=u,Ze=f,H=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!m){var e=this.options.fallbackOnBody?document.body:D,i=T(d,!0,Be,!0,e),n=this.options;if(Be){for(A=e;p(A,"position")==="static"&&p(A,"transform")==="none"&&A!==document;)A=A.parentNode;A!==document.body&&A!==document.documentElement?(A===document&&(A=z()),i.top+=A.scrollTop,i.left+=A.scrollLeft):A=z(),et=yt(A)}m=d.cloneNode(!0),B(m,n.ghostClass,!1),B(m,n.fallbackClass,!0),B(m,n.dragClass,!0),p(m,"transition",""),p(m,"transform",""),p(m,"box-sizing","border-box"),p(m,"margin",0),p(m,"top",i.top),p(m,"left",i.left),p(m,"width",i.width),p(m,"height",i.height),p(m,"opacity","0.8"),p(m,"position",Be?"absolute":"fixed"),p(m,"zIndex","100000"),p(m,"pointerEvents","none"),h.ghost=m,e.appendChild(m),p(m,"transform-origin",Et/parseInt(m.style.width)*100+"% "+wt/parseInt(m.style.height)*100+"%")}},_onDragStart:function(e,i){var n=this,o=e.dataTransfer,r=n.options;if(M("dragStart",this,{evt:e}),h.eventCanceled){this._onDrop();return}M("setupClone",this),h.eventCanceled||(_=Pt(d),_.removeAttribute("id"),_.draggable=!1,_.style["will-change"]="",this._hideClone(),B(_,this.options.chosenClass,!1),h.clone=_),n.cloneId=He(function(){M("clone",n),!h.eventCanceled&&(n.options.removeCloneOnHide||D.insertBefore(_,d),n._hideClone(),N({sortable:n,name:"clone"}))}),!i&&B(d,r.dragClass,!0),i?(ze=!0,n._loopId=setInterval(n._emulateDragOver,50)):(g(document,"mouseup",n._onDrop),g(document,"touchend",n._onDrop),g(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",r.setData&&r.setData.call(n,o,d)),v(document,"drop",n),p(d,"transform","translateZ(0)")),fe=!0,n._dragStartId=He(n._dragStarted.bind(n,i,e)),v(document,"selectstart",n),we=!0,window.getSelection().removeAllRanges(),_e&&p(document.body,"user-select","none")},_onDragOver:function(e){var i=this.el,n=e.target,o,r,a,s=this.options,l=s.group,c=h.active,u=Fe===l,f=s.sort,b=O||c,S,y=this,w=!1;if(at)return;function X(Ee,Wt){M(Ee,y,W({evt:e,isOwner:u,axis:S?"vertical":"horizontal",revert:a,dragRect:o,targetRect:r,canSort:f,fromSortable:b,target:n,completed:P,onMove:function(pt,Ut){return ke(D,i,d,o,pt,T(pt),e,Ut)},changed:j},Wt))}function U(){X("dragOverAnimationCapture"),y.captureAnimationState(),y!==b&&b.captureAnimationState()}function P(Ee){return X("dragOverCompleted",{insertion:Ee}),Ee&&(u?c._hideClone():c._showClone(y),y!==b&&(B(d,O?O.options.ghostClass:c.options.ghostClass,!1),B(d,s.ghostClass,!0)),O!==y&&y!==h.active?O=y:y===h.active&&O&&(O=null),b===y&&(y._ignoreWhileAnimating=n),y.animateAll(function(){X("dragOverAnimationComplete"),y._ignoreWhileAnimating=null}),y!==b&&(b.animateAll(),b._ignoreWhileAnimating=null)),(n===d&&!d.animated||n===i&&!n.animated)&&(ue=null),!s.dragoverBubble&&!e.rootEl&&n!==document&&(d.parentNode[L]._isOutsideThisEl(e.target),!Ee&&se(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),w=!0}function j(){k=Y(d),ee=Y(d,s.draggable),N({sortable:y,name:"change",toEl:i,newIndex:k,newDraggableIndex:ee,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=$(n,s.draggable,i,!0),X("dragOver"),h.eventCanceled)return w;if(d.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||y._ignoreWhileAnimating===n)return P(!1);if(ze=!1,c&&!s.disabled&&(u?f||(a=I!==D):O===this||(this.lastPutMode=Fe.checkPull(this,c,d,e))&&l.checkPut(this,c,d,e))){if(S=this._getDirection(e,n)==="vertical",o=T(d),X("dragOverValid"),h.eventCanceled)return w;if(a)return I=D,U(),this._hideClone(),X("revert"),h.eventCanceled||(le?D.insertBefore(d,le):D.appendChild(d)),P(!0);var F=ut(i,s.draggable);if(!F||vn(e,S,this)&&!F.animated){if(F===d)return P(!1);if(F&&i===e.target&&(n=F),n&&(r=T(n)),ke(D,i,d,o,n,r,e,!!n)!==!1)return U(),F&&F.nextSibling?i.insertBefore(d,F.nextSibling):i.appendChild(d),I=i,j(),P(!0)}else if(F&&gn(e,S,this)){var ie=me(i,0,s,!0);if(ie===d)return P(!1);if(n=ie,r=T(n),ke(D,i,d,o,n,r,e,!1)!==!1)return U(),i.insertBefore(d,ie),I=i,j(),P(!0)}else if(n.parentNode===i){r=T(n);var G=0,oe,ge=d.parentNode!==i,R=!un(d.animated&&d.toRect||o,n.animated&&n.toRect||r,S),ve=S?"top":"left",Q=bt(n,"top","top")||bt(d,"top","top"),be=Q?Q.scrollTop:void 0;ue!==n&&(oe=r[ve],Oe=!1,Re=!R&&s.invertSwap||ge),G=bn(e,n,r,S,R?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Re,ue===n);var q;if(G!==0){var re=Y(d);do re-=G,q=I.children[re];while(q&&(p(q,"display")==="none"||q===m))}if(G===0||q===n)return P(!1);ue=n,Te=G;var ye=n.nextElementSibling,Z=!1;Z=G===1;var Le=ke(D,i,d,o,n,r,e,Z);if(Le!==!1)return(Le===1||Le===-1)&&(Z=Le===1),at=!0,setTimeout(mn,30),U(),Z&&!ye?i.appendChild(d):n.parentNode.insertBefore(d,Z?ye:n),Q&&xt(Q,0,be-Q.scrollTop),I=d.parentNode,oe!==void 0&&!Re&&(je=Math.abs(oe-T(n)[ve])),j(),P(!0)}if(i.contains(d))return P(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){g(document,"mousemove",this._onTouchMove),g(document,"touchmove",this._onTouchMove),g(document,"pointermove",this._onTouchMove),g(document,"dragover",se),g(document,"mousemove",se),g(document,"touchmove",se)},_offUpEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._onDrop),g(e,"touchend",this._onDrop),g(e,"pointerup",this._onDrop),g(e,"pointercancel",this._onDrop),g(e,"touchcancel",this._onDrop),g(document,"selectstart",this)},_onDrop:function(e){var i=this.el,n=this.options;if(k=Y(d),ee=Y(d,n.draggable),M("drop",this,{evt:e}),I=d&&d.parentNode,k=Y(d),ee=Y(d,n.draggable),h.eventCanceled){this._nulling();return}fe=!1,Re=!1,Oe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),st(this.cloneId),st(this._dragStartId),this.nativeDraggable&&(g(document,"drop",this),g(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),_e&&p(document.body,"user-select",""),p(d,"transform",""),e&&(we&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),m&&m.parentNode&&m.parentNode.removeChild(m),(D===I||O&&O.lastPutMode!=="clone")&&_&&_.parentNode&&_.parentNode.removeChild(_),d&&(this.nativeDraggable&&g(d,"dragend",this),tt(d),d.style["will-change"]="",we&&!fe&&B(d,O?O.options.ghostClass:this.options.ghostClass,!1),B(d,this.options.chosenClass,!1),N({sortable:this,name:"unchoose",toEl:I,newIndex:null,newDraggableIndex:null,originalEvent:e}),D!==I?(k>=0&&(N({rootEl:I,name:"add",toEl:I,fromEl:D,originalEvent:e}),N({sortable:this,name:"remove",toEl:I,originalEvent:e}),N({rootEl:I,name:"sort",toEl:I,fromEl:D,originalEvent:e}),N({sortable:this,name:"sort",toEl:I,originalEvent:e})),O&&O.save()):k!==he&&k>=0&&(N({sortable:this,name:"update",toEl:I,originalEvent:e}),N({sortable:this,name:"sort",toEl:I,originalEvent:e})),h.active&&((k==null||k===-1)&&(k=he,ee=Ce),N({sortable:this,name:"end",toEl:I,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){M("nulling",this),D=d=I=m=le=_=Xe=te=ae=H=we=k=ee=he=Ce=ue=Te=O=Fe=h.dragged=h.ghost=h.clone=h.active=null,Ue.forEach(function(e){e.checked=!0}),Ue.length=Qe=Ze=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":d&&(this._onDragOver(e),pn(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],i,n=this.el.children,o=0,r=n.length,a=this.options;o<r;o++)i=n[o],$(i,a.draggable,this.el,!1)&&e.push(i.getAttribute(a.dataIdAttr)||En(i));return e},sort:function(e,i){var n={},o=this.el;this.toArray().forEach(function(r,a){var s=o.children[a];$(s,this.options.draggable,o,!1)&&(n[r]=s)},this),i&&this.captureAnimationState(),e.forEach(function(r){n[r]&&(o.removeChild(n[r]),o.appendChild(n[r]))}),i&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,i){return $(e,i||this.options.draggable,this.el,!1)},option:function(e,i){var n=this.options;if(i===void 0)return n[e];var o=Me.modifyOption(this,e,i);typeof o<"u"?n[e]=o:n[e]=i,e==="group"&&Ft(n)},destroy:function(){M("destroy",this);var e=this.el;e[L]=null,g(e,"mousedown",this._onTapStart),g(e,"touchstart",this._onTapStart),g(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(g(e,"dragover",this),g(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),We.splice(We.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!te){if(M("hideClone",this),h.eventCanceled)return;p(_,"display","none"),this.options.removeCloneOnHide&&_.parentNode&&_.parentNode.removeChild(_),te=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(te){if(M("showClone",this),h.eventCanceled)return;d.parentNode==D&&!this.options.group.revertClone?D.insertBefore(_,d):le?D.insertBefore(_,le):D.appendChild(_),this.options.group.revertClone&&this.animate(d,_),p(_,"display",""),te=!1}}};function pn(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function ke(t,e,i,n,o,r,a,s){var l,c=t[L],u=c.options.onMove,f;return window.CustomEvent&&!J&&!Ne?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=i,l.draggedRect=n,l.related=o||e,l.relatedRect=r||T(e),l.willInsertAfter=s,l.originalEvent=a,t.dispatchEvent(l),u&&(f=u.call(c,l,a)),f}function tt(t){t.draggable=!1}function mn(){at=!1}function gn(t,e,i){var n=T(me(i.el,0,i.options,!0)),o=Nt(i.el,i.options,m),r=10;return e?t.clientX<o.left-r||t.clientY<n.top&&t.clientX<n.right:t.clientY<o.top-r||t.clientY<n.bottom&&t.clientX<n.left}function vn(t,e,i){var n=T(ut(i.el,i.options.draggable)),o=Nt(i.el,i.options,m),r=10;return e?t.clientX>o.right+r||t.clientY>n.bottom&&t.clientX>n.left:t.clientY>o.bottom+r||t.clientX>n.right&&t.clientY>n.top}function bn(t,e,i,n,o,r,a,s){var l=n?t.clientY:t.clientX,c=n?i.height:i.width,u=n?i.top:i.left,f=n?i.bottom:i.right,b=!1;if(!a){if(s&&je<c*o){if(!Oe&&(Te===1?l>u+c*r/2:l<f-c*r/2)&&(Oe=!0),Oe)b=!0;else if(Te===1?l<u+je:l>f-je)return-Te}else if(l>u+c*(1-o)/2&&l<f-c*(1-o)/2)return yn(e)}return b=b||a,b&&(l<u+c*r/2||l>f-c*r/2)?l>u+c/2?1:-1:0}function yn(t){return Y(d)<Y(t)?1:-1}function En(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,n=0;i--;)n+=e.charCodeAt(i);return n.toString(36)}function wn(t){Ue.length=0;for(var e=t.getElementsByTagName("input"),i=e.length;i--;){var n=e[i];n.checked&&Ue.push(n)}}function He(t){return setTimeout(t,0)}function st(t){return clearTimeout(t)}Ve&&v(document,"touchmove",function(t){(h.active||fe)&&t.cancelable&&t.preventDefault()});h.utils={on:v,off:g,css:p,find:Ot,is:function(e,i){return!!$(e,i,e,!1)},extend:nn,throttle:At,closest:$,toggleClass:B,clone:Pt,index:Y,nextTick:He,cancelNextTick:st,detectDirection:Lt,getChild:me,expando:L};h.get=function(t){return t[L]};h.mount=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(h.utils=W(W({},h.utils),n.utils)),Me.mount(n)})};h.create=function(t,e){return new h(t,e)};h.version=en;var C=[],Se,lt,ct=!1,nt,it,qe,De;function Sn(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(i){var n=i.originalEvent;this.sortable.nativeDraggable?v(document,"dragover",this._handleAutoScroll):this.options.supportPointer?v(document,"pointermove",this._handleFallbackAutoScroll):n.touches?v(document,"touchmove",this._handleFallbackAutoScroll):v(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var n=i.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):(g(document,"pointermove",this._handleFallbackAutoScroll),g(document,"touchmove",this._handleFallbackAutoScroll),g(document,"mousemove",this._handleFallbackAutoScroll)),Dt(),$e(),on()},nulling:function(){qe=lt=Se=ct=De=nt=it=null,C.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,n){var o=this,r=(i.touches?i.touches[0]:i).clientX,a=(i.touches?i.touches[0]:i).clientY,s=document.elementFromPoint(r,a);if(qe=i,n||this.options.forceAutoScrollFallback||Ne||J||_e){ot(i,this.options,s,n);var l=ne(s,!0);ct&&(!De||r!==nt||a!==it)&&(De&&Dt(),De=setInterval(function(){var c=ne(document.elementFromPoint(r,a),!0);c!==l&&(l=c,$e()),ot(i,o.options,c,n)},10),nt=r,it=a)}else{if(!this.options.bubbleScroll||ne(s,!0)===z()){$e();return}ot(i,this.options,ne(s,!1),!1)}}},K(t,{pluginName:"scroll",initializeByDefault:!0})}function $e(){C.forEach(function(t){clearInterval(t.pid)}),C=[]}function Dt(){clearInterval(De)}var ot=At(function(t,e,i,n){if(e.scroll){var o=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,s=e.scrollSpeed,l=z(),c=!1,u;lt!==i&&(lt=i,$e(),Se=e.scroll,u=e.scrollFn,Se===!0&&(Se=ne(i,!0)));var f=0,b=Se;do{var S=b,y=T(S),w=y.top,X=y.bottom,U=y.left,P=y.right,j=y.width,F=y.height,ie=void 0,G=void 0,oe=S.scrollWidth,ge=S.scrollHeight,R=p(S),ve=S.scrollLeft,Q=S.scrollTop;S===l?(ie=j<oe&&(R.overflowX==="auto"||R.overflowX==="scroll"||R.overflowX==="visible"),G=F<ge&&(R.overflowY==="auto"||R.overflowY==="scroll"||R.overflowY==="visible")):(ie=j<oe&&(R.overflowX==="auto"||R.overflowX==="scroll"),G=F<ge&&(R.overflowY==="auto"||R.overflowY==="scroll"));var be=ie&&(Math.abs(P-o)<=a&&ve+j<oe)-(Math.abs(U-o)<=a&&!!ve),q=G&&(Math.abs(X-r)<=a&&Q+F<ge)-(Math.abs(w-r)<=a&&!!Q);if(!C[f])for(var re=0;re<=f;re++)C[re]||(C[re]={});(C[f].vx!=be||C[f].vy!=q||C[f].el!==S)&&(C[f].el=S,C[f].vx=be,C[f].vy=q,clearInterval(C[f].pid),(be!=0||q!=0)&&(c=!0,C[f].pid=setInterval((function(){n&&this.layer===0&&h.active._onTouchMove(qe);var ye=C[this.layer].vy?C[this.layer].vy*s:0,Z=C[this.layer].vx?C[this.layer].vx*s:0;typeof u=="function"&&u.call(h.dragged.parentNode[L],Z,ye,t,qe,C[this.layer].el)!=="continue"||xt(C[this.layer].el,Z,ye)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&b!==l&&(b=ne(b,!1)));ct=c}},30),kt=function(e){var i=e.originalEvent,n=e.putSortable,o=e.dragEl,r=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(i){var c=n||r;s();var u=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,f=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function ft(){}ft.prototype={startIndex:null,dragStart:function(e){var i=e.oldDraggableIndex;this.startIndex=i},onSpill:function(e){var i=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=me(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(i,o):this.sortable.el.appendChild(i),this.sortable.animateAll(),n&&n.animateAll()},drop:kt};K(ft,{pluginName:"revertOnSpill"});function ht(){}ht.prototype={onSpill:function(e){var i=e.dragEl,n=e.putSortable,o=n||this.sortable;o.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),o.animateAll()},drop:kt};K(ht,{pluginName:"removeOnSpill"});h.mount(new Sn);h.mount(ht,ft);let E={title:"",sections:[],theme:{primaryColor:"#333333",textColor:"#555555",fontFamily:"'Inter', sans-serif"}},Yt=1,Xt=1;const rt=2e3,Dn=document.getElementById("add-section-btn"),ce=document.getElementById("menu-sections");document.getElementById("preview-iframe");const _n=document.getElementById("size-display"),In=document.getElementById("size-warning"),Ae=document.getElementById("qr-code-img"),xe=document.getElementById("qr-code-placeholder"),Cn=document.getElementById("save-json-btn"),Tn=document.getElementById("load-json-btn"),jt=document.getElementById("json-file-input"),Ht=document.getElementById("menu-title-input"),On=document.getElementById("live-preview-content"),$t=document.getElementById("primary-color"),Gt=document.getElementById("text-color"),zt=document.getElementById("font-select"),_t={vegetarian:{label:"Vegetarian",icon:" V "},vegan:{label:"Vegan",icon:" VG "},spicy:{label:"Spicy",icon:" S "},gluten_free:{label:"Gluten-Free",icon:" GF "},new:{label:"New!",icon:" NEW "}};async function An(t){const e=new TextEncoder,i=await crypto.subtle.importKey("raw",e.encode(t),{name:"PBKDF2"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:e.encode("static-menu-qr-salt"),iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function xn(t,e){const i=await An(e),n=crypto.getRandomValues(new Uint8Array(12)),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},i,new TextEncoder().encode(t)),r=new Uint8Array(n.length+o.byteLength);return r.set(n),r.set(new Uint8Array(o),n.length),btoa(String.fromCharCode.apply(null,r))}async function x(){Kt(On,E);const t=await Nn(),e=t.length;if(_n.textContent=`${e} characters`,In.hidden=e<=rt,E.sections.length>0&&e<=rt)Mn(t),Ae.hidden=!1,xe.style.display="none";else{Ae.src="",Ae.hidden=!0,xe.style.display="flex";const i=xe.querySelector("p");e>rt?i.textContent="Menu is too large for a QR Code.":i.textContent="Your QR code will appear here."}}function Pn(t){return{t:t.title,s:t.sections.map(i=>({n:i.name,i:i.items.map(n=>({n:n.name,p:n.price,d:n.description,img:n.image,tg:n.tags}))})),th:{pc:t.theme.primaryColor,tc:t.theme.textColor,ff:t.theme.fontFamily}}}async function Nn(){if(E.sections.length===0&&!E.title)return"";const t=new Date().toISOString();let e="ip_not_available";try{const u=await fetch("https://api.ipify.org?format=json");u.ok&&(e=(await u.json()).ip)}catch(u){console.error("Could not fetch IP address:",u)}const i=await xn(e,t),o={v:2,menu:Pn(E),meta:{ts:t,eid:i}},r=JSON.stringify(o),a=qt.deflate(r),l=btoa(String.fromCharCode.apply(null,a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return`${new URL("menu.html",window.location.href).href}#data=${l}`}function Mn(t){try{const n=Vt(0,"L");n.addData(t),n.make(),Ae.src=n.createDataURL(10,5)}catch(e){console.error("Error generating QR code:",e);const i=xe.querySelector("p");i.textContent="Could not generate QR code.",Ae.hidden=!0,xe.style.display="flex"}}function Ln(t){const e=document.createElement("div");return e.className="menu-item",e.dataset.itemId=t.id,e.innerHTML=`
    <input type="text" class="item-name-input" placeholder="Item Name" value="${t.name}">
    <input type="text" class="item-price-input" placeholder="Price" value="${t.price}">
    <textarea class="item-desc-input" placeholder="Description">${t.description}</textarea>
    <div class="item-image-container">
      <label for="item-image-${t.id}" class="item-image-label">Add Image</label>
      <input type="file" id="item-image-${t.id}" class="item-image-input" accept="image/jpeg, image/png, image/gif">
      <div class="item-image-preview">
        ${t.image?`<img src="${t.image}" alt="Preview"><button class="remove-image-btn" title="Remove Image">&times;</button>`:"<span>No Image</span>"}
      </div>
    </div>
    <div class="item-tags-container">
      ${Object.keys(_t).map(i=>`
        <label class="item-tag-label">
          <input type="checkbox" class="item-tag-checkbox" data-tag="${i}" ${(t.tags||[]).includes(i)?"checked":""}>
          ${_t[i].label}
        </label>
      `).join("")}
    </div>
    <button class="delete-item-btn" title="Delete Item"><i class="fas fa-trash"></i></button>
  `,e}function Fn(t){const e=document.createElement("div");e.className="menu-section",e.dataset.sectionId=t.id,e.innerHTML=`
      <div class="menu-section-header">
        <input type="text" class="section-name-input" placeholder="Section Name (e.g., Appetizers)" value="${t.name}">
        <button class="delete-section-btn" title="Delete Section"><i class="fas fa-trash"></i> Delete Section</button>
      </div>
      <div class="menu-items">
        <!-- Menu items will be rendered here -->
      </div>
      <button class="add-item-btn"><i class="fas fa-plus"></i> Add Menu Item</button>
    `;const i=e.querySelector(".menu-items");return t.items.forEach(n=>{const o=Ln(n);i.appendChild(o)}),e}function Pe(){ce.innerHTML="",E.sections.length===0?ce.innerHTML='<p>No sections yet. Click "Add Section" to get started!</p>':E.sections.forEach(t=>{const e=Fn(t);ce.appendChild(e)}),Rn(),x()}Dn.addEventListener("click",()=>{const t={id:`section-${Yt++}`,name:"",items:[]};E.sections.push(t),Pe(),x()});ce.addEventListener("click",t=>{const i=t.target.closest("button");if(i){if(i.classList.contains("delete-section-btn")){const n=i.closest(".menu-section");n.classList.add("hiding"),n.addEventListener("animationend",()=>{const o=n.dataset.sectionId;E.sections=E.sections.filter(r=>r.id!==o),Pe(),x()},{once:!0})}if(i.classList.contains("add-item-btn")){const n=i.closest(".menu-section").dataset.sectionId,o=E.sections.find(a=>a.id===n),r={id:`item-${Xt++}`,name:"",price:"",description:"",image:null,tags:[]};o.items.push(r),Pe()}if(i.classList.contains("delete-item-btn")){const n=i.closest(".menu-item");n.classList.add("hiding"),n.addEventListener("animationend",()=>{const r=i.closest(".menu-section").dataset.sectionId,a=n.dataset.itemId,s=E.sections.find(l=>l.id===r);s.items=s.items.filter(l=>l.id!==a),n.remove(),x()},{once:!0})}if(i.classList.contains("remove-image-btn")){const n=i.closest(".menu-item"),r=i.closest(".menu-section").dataset.sectionId,a=n.dataset.itemId,l=E.sections.find(u=>u.id===r).items.find(u=>u.id===a);l.image=null;const c=n.querySelector(".item-image-preview");c.innerHTML="<span>No Image</span>",x()}}});ce.addEventListener("input",t=>{const e=t.target,i=e.closest(".menu-section");if(!i)return;const n=i.dataset.sectionId,o=E.sections.find(r=>r.id===n);if(e.classList.contains("section-name-input")&&(o.name=e.value),e.classList.contains("item-name-input")||e.classList.contains("item-price-input")||e.classList.contains("item-desc-input")){const a=e.closest(".menu-item").dataset.itemId,s=o.items.find(l=>l.id===a);e.classList.contains("item-name-input")&&(s.name=e.value),e.classList.contains("item-price-input")&&(s.price=e.value),e.classList.contains("item-desc-input")&&(s.description=e.value)}x()});ce.addEventListener("change",async t=>{if(t.target.classList.contains("item-image-input")){const e=t.target.files[0];if(!e)return;const i=100;if(e.size>i*1024){alert(`Image is too large. Please select an image smaller than ${i}KB.`),t.target.value="";return}const n=t.target.closest(".menu-item"),r=t.target.closest(".menu-section").dataset.sectionId,a=n.dataset.itemId,l=E.sections.find(c=>c.id===r).items.find(c=>c.id===a);try{const c=await Bn(e);l.image=c;const u=n.querySelector(".item-image-preview");u.innerHTML=`<img src="${c}" alt="Preview"><button class="remove-image-btn" title="Remove Image">&times;</button>`,x()}catch(c){console.error("Error reading file:",c),alert("Could not read the image file.")}}if(t.target.classList.contains("item-tag-checkbox")){const e=t.target.closest(".menu-item"),n=t.target.closest(".menu-section").dataset.sectionId,o=e.dataset.itemId,a=E.sections.find(l=>l.id===n).items.find(l=>l.id===o),s=t.target.dataset.tag;t.target.checked?a.tags.push(s):a.tags=a.tags.filter(l=>l!==s),x()}});$t.addEventListener("input",t=>{E.theme.primaryColor=t.target.value,x()});Gt.addEventListener("input",t=>{E.theme.textColor=t.target.value,x()});zt.addEventListener("change",t=>{E.theme.fontFamily=t.target.value,x()});Ht.addEventListener("input",t=>{E.title=t.target.value,x()});Cn.addEventListener("click",()=>{if(E.sections.length===0){alert("Menu is empty. Nothing to save.");return}const t=JSON.stringify(E,null,2),e=new Blob([t],{type:"application/json"}),i=URL.createObjectURL(e),n=document.createElement("a");n.href=i,n.download="menu.json",n.click(),URL.revokeObjectURL(i)});Tn.addEventListener("click",()=>{jt.click()});jt.addEventListener("change",t=>{const e=t.target.files[0];if(!e)return;const i=new FileReader;i.onload=n=>{try{const o=JSON.parse(n.target.result);if(typeof o=="object"&&o.title!==void 0&&Array.isArray(o.sections)){E=o;const r=o.sections||[],a=Math.max(0,...r.map(c=>parseInt(c.id.split("-")[1]||0))),s=r.flatMap(c=>c.items),l=Math.max(0,...s.map(c=>parseInt(c.id.split("-")[1]||0)));Yt=a+1,Xt=l+1,Ht.value=E.title,$t.value=E.theme.primaryColor,Gt.value=E.theme.textColor,zt.value=E.theme.fontFamily,Pe(),x()}else alert("Invalid or corrupted v2 JSON file.")}catch(o){alert("Error reading JSON file: "+o.message)}},i.readAsText(e),t.target.value=""});function Rn(){new h(ce,{animation:150,handle:".menu-section-header",ghostClass:"sortable-ghost",onEnd:t=>{const[e]=E.sections.splice(t.oldIndex,1);E.sections.splice(t.newIndex,0,e),x()}}),document.querySelectorAll(".menu-items").forEach(t=>{new h(t,{animation:150,ghostClass:"sortable-ghost-item",onEnd:e=>{const n=e.from.closest(".menu-section").dataset.sectionId,o=E.sections.find(r=>r.id===n);if(o){const[r]=o.items.splice(e.oldIndex,1);o.items.splice(e.newIndex,0,r),x()}}})})}function Bn(t){return new Promise((e,i)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=o=>i(o),n.readAsDataURL(t)})}function kn(){Pe(),x()}kn();
